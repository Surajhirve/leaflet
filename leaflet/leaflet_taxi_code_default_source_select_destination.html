<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title></title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css" />
<link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
<link rel="stylesheet" type="text/css" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css"><!-- Leaflet Control Geocoder: -->

</head>
<style>
	
	body{
		margin: 0;
		padding:0;
	}

	#map{
		width: 100%;
		height:100vh;
	}


</style>
<body>
    
    <div id="map"></div>

</body>

  <script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script>
  <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
  <script type="text/javascript" src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script><!-- Leaflet Control Geocoder: -->

<script>
	
	var map = L.map('map').setView([18.5248706,73.6981497], 11);
	 var mapLink = "<a href='http://openstreetmap.org'>OpenStreetMap</a>";
        L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
            attribution: 'Leaflet &copy; ' + mapLink + ', contribution',
            maxZoom: 18
        }).addTo(map);

         // Add Geocoder (search bar)

        L.Control.geocoder().addTo(map);

          // Taxi icon setup

        const taxiIcon = L.icon({
        	iconUrl:'Taxi_Icon (1).png',// Make sure this path is valid on your server
        	iconSize :[50,50],
        	iconAnchor : [25,25]
        });
          // Add initial taxi marker
        const marker = L.marker([18.4678407,73.8197168],{icon:taxiIcon}).addTo(map);

        	 // Store and remove previous route control
        	let routeControl = null;

        	map.on('click',function(e){
        		const destination = e.latlng;

        	 // Add destination marker
               L.marker(destination).addTo(map);

              // Remove old route control if it exists
               if(routeControl){
               	map.removeControl(routeControl);
               }

                // Add new routing control
               routeControl =L.Routing.control({
               	waypoints :[ L.latLng(marker.getLatLng()),destination],
               	createMarker : ()=> null     // Prevents auto-markers by Routing Machine
               }).on('routesfound',function(e){
               	const coords = e.routes[0].coordinates;

               	 // Animate taxi along route

               	coords.forEach((coord,index)=>{
               		setTimeout(()=>{
               			marker.setLatLng([coord.lat,coord.lng]);
               		},70 * index);
               	});
               }).addTo(map);
               });
        

</script>
</html>